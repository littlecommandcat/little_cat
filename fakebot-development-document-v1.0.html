<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>分身機器人開發文檔</title>

  <meta name="description" content="小喵喵是一款強大的 Discord 機器人，支援音樂播放、管理功能、客服單與安全系統。" />
  <meta name="keywords" content="小喵喵, Discord 機器人, Discord Bot, 音樂機器人" />
  <meta property="og:title" content="小喵喵分身機器人模組文檔" />
  <meta property="og:description" content="小喵喵分身機器人教學文檔" />
  <meta property="og:type" content="website" />
  <meta property="og:image" content="cat.png">
  <link rel="icon" href="cat.png" type="image/x-icon" />

  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet" />
  <link rel="stylesheet" type="text/css" href="document.css">
</head>
<body>

<header>
  <div class="container header-container">
    <div class="logo">
        <img src="cat.png" alt="小喵喵 Logo" style="height: 40px; vertical-align: middle;">
        <span style="margin-left: 8px; vertical-align: middle;">分身機器人文檔</span>
    </div>
    <nav>
      <ul>
        <li><a href="index.html">主頁面</a></li>
        <li><a href="#syntax">核心語法</a></li>
        <li><a href="#libs">函式</a></li>
        <li><a href="#libs">內建庫</a></li>
        <li><a href="#constraints">運行限制</a></li>
        <li><a href="#example">完整範例</a></li>
      </ul>
    </nav>
  </div>
</header>

<section class="hero container">
  <p>本頁面說明分身機器人簡易語言的語法規範、內置函數以及安全限制。<br>當前直譯器穩定版本為 <b>v3.6</b>，支援非同步運算與動態庫加載。</p>
</section>

<section id="syntax" class="container">
  <h2>核心結構 (Core Structure)</h2>
  <div class="code-block">
    <button class="copy-btn">複製</button>
    <pre><code>#load &lt;lib&gt; // 載入內建庫
begin; // 主程式開始
  // 變數賦值
  val = 100;
    
  // 輸出結果 (必填)
  output {"結果是: " + val};
  // 或是 output {"結果是: " val};
end; // 主程式結束</code></pre>
  </div>
  <table>
    <tr><th>指令/關鍵字</th><th>範例</th><th>說明</th></tr>
    <tr><td>#load</td><td>#load &lt;math&gt;</td><td>加載外部擴充庫（如 math, message)</td></tr>
    <tr><td>begin / end</td><td>begin; ... end;</td><td>定義程式執行的主區塊</td></tr>
    <tr><td>output</td><td>output {content};</td><td>設定程式的最終回傳內容且僅會執行一次（必須存在）</td></tr>
    <tr><td>//</td><td>// 註解</td><td>單行註解，執行時會被忽略</td></tr>
    <tr><td>;</td><td>res = a + b;</td><td>每行指令結尾必須加上分號（結構詞除外）</td></tr>
  </table>
</section>


<section id="functions" class="container">
  <h2>函式 (Function Definition)</h2>
  <p>你可以使用 <code>func</code> 關鍵字封裝重複使用的邏輯。請注意函數必須定義在 <code>begin</code> 區塊之前。</p>
  
  <div class="grid">
    <div class="card code-block">
      <h3>函數定義語法</h3>
      <button class="copy-btn">複製</button>
      <pre><code>func &lt;函數名稱&gt; {參數1 參數2 ...};
  // 邏輯處理
  res = 參數1 + 參數2;
  sendback {res}; // 回傳結果
endfunc;</code></pre>
    </div>
    <div class="card code-block">
      <h3>如何調用函數 (含內建庫函式)</h3>
      <button class="copy-btn">複製</button>
      <pre><code>begin;
  // 使用 call 關鍵字調用
  result = call &lt;函數名稱&gt;{val1 val2};
  output {result};
end;</code></pre>
    </div>
  </div>

  <table>
    <tr><th>規則項目</th><th>說明</th></tr>
    <tr><td><b>定義位置</b></td><td>所有 <code>func</code> 必須寫在腳本的最上方（<code>#load</code> 之後，<code>begin</code> 之前）。</td></tr>
    <tr><td><b>參數傳遞</b></td><td>參數置於大括號 <code>{}</code> 中，彼此以<b>空格</b>分隔。</td></tr>
    <tr><td><b>回傳機制</b></td><td>使用 <code>sendback {值};</code> 來將結果傳回給調用者。</td></tr>
    <tr><td><b>安全限制</b></td><td><b>禁止</b>在 <code>func</code> 區塊內使用 <code>wait</code> 指令。</td></tr>
    <tr><td><b>作用域</b></td><td>函數內定義的變數為區域變數，不會影響主程式。</td></tr>
  </table>
</section>

<section id="libs" class="container">
  <h2>內建庫與函數註冊</h2>
  <div class="grid">
    <div class="card code-block">
      <h3>math - 數學運算</h3>
      <button class="copy-btn">複製</button>
      <pre><code>#load &lt;math&gt;
begin;
  res = call math.add{5 10}; // call func
  pi_val = math.pi;
end;</code></pre>
    </div>
    <div class="card code-block">
      <h3>message - 訊息資料</h3>
      <button class="copy-btn">複製</button>
      <pre><code>#load &lt;message&gt;
begin;
  content = message.content;
  user = message.username;
  id = message.id;
end;</code></pre>
    </div>
    <div class="card code-block">
      <h3>list - 列表操作</h3>
      <button class="copy-btn">複製</button>
      <pre><code>my_list = [1, 2, 3];
list.add{my_list 4};
list.pop{1};
val = list.get{my_list 0};
len = list.length{my_list};
random_val = list.random{list 1}
// 或是省略數量 random_val = list.random{list}
</code></pre>
    </div>
  </div>
  <table>
    <tr><th>函數/屬性</th><th>型態</th><th>說明</th></tr>
    <tr><td>math.pi / math.e</td><td>float</td><td>圓周率與自然常數</td></tr>
    <tr><td>math.add{a b}</td><td>func</td><td>回傳 a + b 的結果</td></tr>
    <tr><td>message.content</td><td>str</td><td>當前觸發程式的訊息文字內容</td></tr>
    <tr><td>message.username</td><td>str</td><td>當前觸發程式的訊息的作者名稱</td></tr>
    <tr><td>message.id</td><td>str</td><td>當前觸發程式的訊息 id</td></tr>
    
    <tr><td>list.add{list val}</td><td>func</td><td>在列表末尾新增一個元素</td></tr>
    <tr><td>list.pop{list idx}</td><td>func</td><td>移除並回傳指定索引的元素</td></tr>
    <tr><td>list.get{list idx}</td><td>func</td><td>取得指定索引的元素內容</td></tr>
    <tr><td>list.length{list}</td><td>int</td><td>取得列表的總長度 (元素數量)</td></tr>
    <tr><td>list.random{list n}</td><td>list/val</td><td>從列表中隨機抽取 n 個元素</td></tr>

    <tr><td>str.upper{text}</td><td>str</td><td>將文字轉換為全大寫</td></tr>
    <tr><td>str.lower{text}</td><td>str</td><td>將文字轉換為全小寫</td></tr>
    <tr><td>turntype{val type}</td><td>func</td><td>轉換型態 (str, int, float, list)</td></tr>
    <tr><td>type{val}</td><td>func</td><td>確認變數型態</td></tr>
    <tr><td>wait{time}</td><td>func</td><td>暫停執行 (限制 0.1 ~ 0.5 秒)</td></tr>
  </table>
</section>

<section id="constraints" class="container">
  <h2>運行安全性驗證 (Constraints)</h2>
  <ul>
    <li><b>等待限制</b>：單個程式內 <code>wait</code> 指令不得超過 4 次。</li>
    <li><b>迴圈限制</b>：<code>for</code> 迴圈總數不得超過 3 個，且巢狀深度最大為 2。</li>
    <li><b>迴圈次數</b>：單次 <code>for</code> 迭代次數上限為 5 次。</li>
    <li><b>函數限制</b>：在 <code>func</code> 定義區塊內禁止使用 <code>wait</code> 指令。</li>
    <li><b>語法檢查</b>：若遺漏分號 <code>;</code> 或 <code>begin/end</code>，直譯器將拒絕執行並報錯。</li>
  </ul>
</section>

<section id="example" class="container">
  <h2>完整程式範例</h2>
  <div class="code-block">
    <button class="copy-btn">複製</button>
    <pre><code>#load &lt;math&gt;
#load &lt;message&gt;

func welcome {name};
  res = "你好, " + name;
  sendback {res};
endfunc;

begin;
  user = message.username;
  greet = call welcome{user}; // call func
    
  // 迴圈示範 (執行 3 次)
  for i in 3;
    output_msg = greet + " 第 " + i + " 次打招呼";
  endfor;
    
  output {output_msg};
end;</code></pre>
  </div>
</section>

<section class="cta">
  <h2>準備好開始使用分身機器人了嗎？</h2>
  <a class="btn-primary" href="#example">立即使用範例</a>
</section>

<footer>
  <p>© 2026 小喵喵 Discord Bot. All rights reserved.</p>
</footer>

<script>
    const observer = new IntersectionObserver(entries => {
        entries.forEach(entry => {
        if(entry.isIntersecting) entry.target.classList.add('visible');
        });
    });
    document.querySelectorAll('section').forEach(section => observer.observe(section));
    
    document.querySelectorAll('.copy-btn').forEach(btn => {
        btn.addEventListener('click', () => {
            const code = btn.nextElementSibling.innerText;
            navigator.clipboard.writeText(code).then(() => {
                btn.innerText = '已複製';
                setTimeout(() => btn.innerText = '複製', 1500);
            }).catch(err => {
                console.error('複製失敗', err);
            });
        });
    });
</script>

</body>
</html>